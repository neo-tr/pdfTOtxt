# PDF → TXT → JSON Orchestrator

Этот скрипт управляет полным конвейером обработки PDF:  

1. Преобразование PDF в чистый текст (`pdf2text.py`)  
2. Преобразование текста в JSON с извлечением `title` и `arXiv ID` (`text2json.py`)  
3. Опционально: создание JSON метаданных  
4. Опционально: удаление промежуточных `.txt` файлов  

---

## Установка

Убедитесь, что `pdf2text.py` и `text2json.py` лежат в той же папке.  
Скрипт проверенно работает с Python 3.13.2 и требует установленных библиотек.  

```bash
pip install -r requirements.txt
```

---

## Использование

### Базовый запуск

```bash
python orchestrator.py <PDF_DIR> --out-dir <OUTPUT_DIR> 
```
  
### Флаги

| Флаг                   | Описание                                                        | Пример использования      |
| ---------------------- | --------------------------------------------------------------- | ------------------------- |
| `--out-dir <dir>`      | Папка для вывода TXT и JSON                                     | `--out-dir parsed`        |
| `--converter <script>` | Скрипт для конвертации PDF → TXT (по умолчанию `pdf2text.py`)   | `--converter pdf2text.py` |
| `--parser <script>`    | Скрипт для конвертации TXT → JSON (по умолчанию `text2json.py`) | `--parser text2json.py`   |
| `--metaout <dir>`      | Папка для метаданных (title, authors, abstract)                 | `--metaout meta`          |
| `--no-meta`            | Не создавать мета JSON файлы даже при наличии `--metaout`       | `--no-meta`               |
| `--delete_txt`         | Удаляет промежуточные TXT после создания JSON                   | `--delete_txt`            |

### Вариант кастомных скриптов

Можно реализовать пайплайн на других скриптах или указывать до них путь: 

```bash
python orchestrator.py pdfs/ --out-dir parsed \  
    --converter my_pdf_converter.py \  
    --parser my_text_parser.py
```

---

## Особенности: 
1. Скрипт обрабатывает только файлы PDF в указанной папке, подпапки игнорируются  
2. Ошибки конвертации одного файла не останавливают обработку остальных файлов  
3. JSON всегда собираются в поддиректории json/ внутри --out-dir  
4. Мета-файлы создаются только при явном указании --metaout и отсутствии флага --no-meta  

## import
| Библиотека      | Версия      | Примечание                        |
| --------------- | ----------- | --------------------------------- |
| jsonpointer     | 2.1         | Для текст2json / работы с JSON    |
| mkl-service     | 2.4.0       | Для numpy и pandas ускорения      |
| numpy           | 2.2.5       | Математические операции, в pandas |
| pandas          | 2.3.3       | Для работы с таблицами и данными  |
| PyMuPDF         | 1.26.4      | Чтение PDF                        |
| python-dateutil | 2.9.0.post0 | Для работы с датами               |
| pytz            | 2025.2      | Временные зоны                    |
| regex           | 2025.9.18   | Расширенные регулярные выражения  |
| setuptools      | 72.1.0      | Установка пакетов                 |
| six             | 1.17.0      | Совместимость Python 2/3 (пакеты) |
| tzdata          | 2025.2      | Данные по временным зонам         |
| wheel           | 0.45.1      | Сборка wheel-пакетов              |
| tqdm            | 4.67.1      | pdf2text (прогресс бар)           |

